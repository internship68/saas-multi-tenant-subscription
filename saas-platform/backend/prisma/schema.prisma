generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Organization {
  id            String         @id @default(uuid())
  name          String
  createdAt     DateTime       @default(now())
  subscriptions Subscription[]
  users         User[]
  invitations   Invitation[]
}

model User {
  id             String       @id
  email          String       @unique
  password       String
  name           String
  role           String
  organizationId String
  createdAt      DateTime     @default(now())

  organization   Organization @relation(fields: [organizationId], references: [id])

  @@index([organizationId])
  @@index([email])
}

model Subscription {
  id                 String   @id
  organizationId     String
  plan               String
  status             String
  currentPeriodStart DateTime
  currentPeriodEnd   DateTime
  createdAt          DateTime @default(now())

  organization Organization @relation(fields: [organizationId], references: [id])

  @@index([organizationId])
}

model Invitation {
  id             String       @id @default(uuid())
  email          String
  organizationId String
  token          String       @unique
  role           String       @default("MEMBER")
  status         String       @default("PENDING") // PENDING, ACCEPTED
  createdAt      DateTime     @default(now())

  organization   Organization @relation(fields: [organizationId], references: [id])

  @@unique([email, organizationId])
  @@index([organizationId])
  @@index([token])
}
